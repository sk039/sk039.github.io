<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en">
    <title>kscr</title>
    <link rel="self" type="application/atom+xml" href="https://kscr-rust.github.io/rust/atom.xml"/>
    <link rel="alternate" type="text/html" href="https://kscr-rust.github.io/rust/"/>
    <generator uri="https://www.getzola.org/">Zola</generator>
    <updated>2022-08-28T00:00:00+00:00</updated>
    <id>https://kscr-rust.github.io/rust/atom.xml</id>
    <entry xml:lang="en">
        <title>使用 Rust 构建原生安卓应用（NDK、Vulkan）</title>
        <published>2022-08-28T00:00:00+00:00</published>
        <updated>2022-08-28T00:00:00+00:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="https://kscr-rust.github.io/rust/rust-android-native-app/"/>
        <id>https://kscr-rust.github.io/rust/rust-android-native-app/</id>
        
        <content type="html" xml:base="https://kscr-rust.github.io/rust/rust-android-native-app/">&lt;h2 id=&quot;xiang-mu-jie-shao&quot;&gt;项目介绍&lt;&#x2F;h2&gt;
&lt;p&gt;https:&#x2F;&#x2F;github.com&#x2F;atkurtul&#x2F;AndroidVulkanTriangle.git&lt;&#x2F;p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;注意：&lt;&#x2F;strong&gt;&lt;&#x2F;em&gt; 运行此项目需要打上文末补丁。&lt;&#x2F;p&gt;
&lt;p&gt;主要修改：&lt;&#x2F;p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;rust 动态库构建改用 cargo-ndk&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;去除 Vulkan Validation Layer 相关函数调用&lt;&#x2F;p&gt;
&lt;p&gt;因为新版本 NDK 已不集成相关二进制 so 文件，此功能是用来调试，去除它不影响项目演示。&lt;&#x2F;p&gt;
&lt;p&gt;Vulkan Tutorial 04 理解Validation layers：&lt;&#x2F;p&gt;
&lt;p&gt;https:&#x2F;&#x2F;www.cnblogs.com&#x2F;heitao&#x2F;p&#x2F;6903297.html&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
&lt;p&gt;构建方法：&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash z-code&quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;z-source z-shell z-bash&quot;&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-comment z-begin z-shell&quot;&gt;#&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-shell&quot;&gt; 安装 apk 构建依赖&lt;&#x2F;span&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-shell&quot;&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-shell z-bash&quot;&gt;&lt;span class=&quot;z-meta z-function-call z-shell&quot;&gt;&lt;span class=&quot;z-variable z-function z-shell&quot;&gt;$&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-function-call z-arguments z-shell&quot;&gt; sudo apt install aapt zipalign&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-shell z-bash&quot;&gt;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-shell z-bash&quot;&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-comment z-begin z-shell&quot;&gt;#&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-shell&quot;&gt; 编译 rust 动态库&lt;&#x2F;span&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-shell&quot;&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-shell z-bash&quot;&gt;&lt;span class=&quot;z-meta z-function-call z-shell&quot;&gt;&lt;span class=&quot;z-variable z-function z-shell&quot;&gt;$&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-function-call z-arguments z-shell&quot;&gt; .&#x2F;build.sh&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-shell z-bash&quot;&gt;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-shell z-bash&quot;&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-comment z-begin z-shell&quot;&gt;#&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-shell&quot;&gt; 构建 apk&lt;&#x2F;span&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-shell&quot;&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-shell z-bash&quot;&gt;&lt;span class=&quot;z-meta z-function-call z-shell&quot;&gt;&lt;span class=&quot;z-variable z-function z-shell&quot;&gt;$&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-function-call z-arguments z-shell&quot;&gt; .&#x2F;package.sh&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;bu-ding&quot;&gt;补丁&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;diff&quot; class=&quot;language-diff z-code&quot;&gt;&lt;code class=&quot;language-diff&quot; data-lang=&quot;diff&quot;&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;diff --git a&#x2F;build.sh b&#x2F;build.sh
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;index 8fa5923..fd3918e 100755
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-meta z-diff z-header z-from-file&quot;&gt;&lt;span class=&quot;z-meta z-header z-from-file z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-from-file z-diff&quot;&gt;---&lt;&#x2F;span&gt; a&#x2F;build.sh
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-meta z-diff z-header z-to-file&quot;&gt;&lt;span class=&quot;z-meta z-header z-to-file z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-to-file z-diff&quot;&gt;+++&lt;&#x2F;span&gt; b&#x2F;build.sh
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-meta z-diff z-range z-unified&quot;&gt;&lt;span class=&quot;z-meta z-range z-unified z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-range z-diff&quot;&gt;@@&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-toc-list z-line-number z-diff&quot;&gt;-1,2 +1,3&lt;&#x2F;span&gt; &lt;span class=&quot;z-punctuation z-definition z-range z-diff&quot;&gt;@@&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-deleted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-deleted z-diff&quot;&gt;-&lt;&#x2F;span&gt;cargo build --target x86_64-linux-android --release
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-deleted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-deleted z-diff&quot;&gt;-&lt;&#x2F;span&gt;#cargo build --target aarch64-linux-android --release
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;\ No newline at end of file
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-inserted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-inserted z-diff&quot;&gt;+&lt;&#x2F;span&gt;#cargo build --target x86_64-linux-android --release
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-inserted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-inserted z-diff&quot;&gt;+&lt;&#x2F;span&gt;CARGO_ENCODED_RUSTFLAGS=&amp;quot;-landroid&amp;quot; cargo ndk -t arm64-v8a -p 30 -o .&#x2F;jniLibs build
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-inserted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-inserted z-diff&quot;&gt;+&lt;&#x2F;span&gt;#cargo build --target aarch64-linux-android --release
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;diff --git a&#x2F;package.sh b&#x2F;package.sh
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;index bcf457e..6e8d104 100755
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-meta z-diff z-header z-from-file&quot;&gt;&lt;span class=&quot;z-meta z-header z-from-file z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-from-file z-diff&quot;&gt;---&lt;&#x2F;span&gt; a&#x2F;package.sh
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-meta z-diff z-header z-to-file&quot;&gt;&lt;span class=&quot;z-meta z-header z-to-file z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-to-file z-diff&quot;&gt;+++&lt;&#x2F;span&gt; b&#x2F;package.sh
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-meta z-diff z-range z-unified&quot;&gt;&lt;span class=&quot;z-meta z-range z-unified z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-range z-diff&quot;&gt;@@&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-toc-list z-line-number z-diff&quot;&gt;-1,19 +1,21&lt;&#x2F;span&gt; &lt;span class=&quot;z-punctuation z-definition z-range z-diff&quot;&gt;@@&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-deleted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-deleted z-diff&quot;&gt;-&lt;&#x2F;span&gt;ARCH=x86_64
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-inserted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-inserted z-diff&quot;&gt;+&lt;&#x2F;span&gt;ARCH=arm64-v8a
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; RARCH=$ARCH
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; mkdir -p apk&#x2F;libs&#x2F;lib&#x2F;$ARCH
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; SONAME=$(grep android.app.lib_name AndroidManifest.xml | grep -oP &amp;#39;android:value=&amp;quot;\K(.*)&amp;quot;&amp;#39;)
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; OUT=&amp;quot;apk&#x2F;libs&#x2F;lib&#x2F;$ARCH&#x2F;lib&amp;quot;${SONAME%\&amp;quot;}&amp;quot;.so&amp;quot;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; 
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-deleted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-deleted z-diff&quot;&gt;-&lt;&#x2F;span&gt;cp target&#x2F;$RARCH-linux-android&#x2F;release&#x2F;librust_vk_main.so $OUT
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-inserted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-inserted z-diff&quot;&gt;+&lt;&#x2F;span&gt;#cp target&#x2F;$RARCH-linux-android&#x2F;release&#x2F;librust_vk_main.so $OUT
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-inserted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-inserted z-diff&quot;&gt;+&lt;&#x2F;span&gt;cp jniLibs&#x2F;arm64-v8a&#x2F;librust_vk_main.so $OUT
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; 
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-deleted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-deleted z-diff&quot;&gt;-&lt;&#x2F;span&gt;readelf $OUT -d &amp;gt; sym.txt
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-deleted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-deleted z-diff&quot;&gt;-&lt;&#x2F;span&gt;readelf $OUT -s &amp;gt;&amp;gt; sym.txt
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-inserted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-inserted z-diff&quot;&gt;+&lt;&#x2F;span&gt;#readelf $OUT -d &amp;gt; sym.txt
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-inserted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-inserted z-diff&quot;&gt;+&lt;&#x2F;span&gt;#readelf $OUT -s &amp;gt;&amp;gt; sym.txt
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; VALIDATION_LAYER=$ANDROID_NDK_HOME&#x2F;sources&#x2F;third_party&#x2F;vulkan&#x2F;src&#x2F;build-android&#x2F;jniLibs&#x2F;$ARCH&#x2F;libVkLayer_khronos_validation.so
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-deleted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-deleted z-diff&quot;&gt;-&lt;&#x2F;span&gt;cp $VALIDATION_LAYER apk&#x2F;libs&#x2F;lib&#x2F;$ARCH
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-inserted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-inserted z-diff&quot;&gt;+&lt;&#x2F;span&gt;#cp $VALIDATION_LAYER apk&#x2F;libs&#x2F;lib&#x2F;$ARCH
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; aapt package -f -M AndroidManifest.xml -I $ANDROID_SDK_ROOT&#x2F;platforms&#x2F;android-30&#x2F;android.jar -A assets -F apk&#x2F;app0.apk apk&#x2F;libs
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; zipalign -f -v 4 apk&#x2F;app0.apk apk&#x2F;app.apk
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-deleted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-deleted z-diff&quot;&gt;-&lt;&#x2F;span&gt;signapk.sh apk&#x2F;app.apk
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-deleted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-deleted z-diff&quot;&gt;-&lt;&#x2F;span&gt;apkanalyzer files list apk&#x2F;app.apk
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-inserted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-inserted z-diff&quot;&gt;+&lt;&#x2F;span&gt;#signapk.sh apk&#x2F;app.apk
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-inserted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-inserted z-diff&quot;&gt;+&lt;&#x2F;span&gt;jarsigner -verbose -keystore ~&#x2F;.android&#x2F;debug.keystore apk&#x2F;app.apk androiddebugkey
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-inserted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-inserted z-diff&quot;&gt;+&lt;&#x2F;span&gt;#apkanalyzer files list apk&#x2F;app.apk
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; #adb uninstall com.native_activity
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; #adb install apk&#x2F;app.apk
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; #adb logcat -c
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;diff --git a&#x2F;src&#x2F;build.rs b&#x2F;src&#x2F;build.rs
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;index 26a2f05..ed71e8a 100644
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-meta z-diff z-header z-from-file&quot;&gt;&lt;span class=&quot;z-meta z-header z-from-file z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-from-file z-diff&quot;&gt;---&lt;&#x2F;span&gt; a&#x2F;src&#x2F;build.rs
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-meta z-diff z-header z-to-file&quot;&gt;&lt;span class=&quot;z-meta z-header z-to-file z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-to-file z-diff&quot;&gt;+++&lt;&#x2F;span&gt; b&#x2F;src&#x2F;build.rs
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-meta z-diff z-range z-unified&quot;&gt;&lt;span class=&quot;z-meta z-range z-unified z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-range z-diff&quot;&gt;@@&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-toc-list z-line-number z-diff&quot;&gt;-6,10 +6,10&lt;&#x2F;span&gt; &lt;span class=&quot;z-punctuation z-definition z-range z-diff&quot;&gt;@@&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-section z-diff&quot;&gt;fn main() {&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;     let target = env::vars().find_map(|(k, v)| if k == &amp;quot;TARGET&amp;quot; { Some(v) } else { None }).unwrap();
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;     let toolchain = env::vars().find_map(|(k, v)| if k == &amp;quot;ANDROID_TOOLCHAIN&amp;quot; { Some(v) } else { None }).unwrap();
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;     let compiler = toolchain.clone() + &amp;quot;&#x2F;bin&#x2F;&amp;quot; + target.as_str() + &amp;quot;30-clang&amp;quot;;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-deleted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-deleted z-diff&quot;&gt;-&lt;&#x2F;span&gt;    let ar =  toolchain + &amp;quot;&#x2F;bin&#x2F;&amp;quot; + target.as_str() + &amp;quot;-ar&amp;quot;;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-inserted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-inserted z-diff&quot;&gt;+&lt;&#x2F;span&gt;    let ar =  toolchain + &amp;quot;&#x2F;bin&#x2F;llvm-ar&amp;quot;;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;     cc::Build::new()
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;         .file(&amp;quot;src&#x2F;vk.c&amp;quot;)
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;         .compiler(compiler)
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;         .archiver(ar)
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;         .compile(&amp;quot;libvk.a&amp;quot;);
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-deleted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-deleted z-diff&quot;&gt;-&lt;&#x2F;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;\ No newline at end of file
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-inserted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-inserted z-diff&quot;&gt;+&lt;&#x2F;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;diff --git a&#x2F;src&#x2F;lib.rs b&#x2F;src&#x2F;lib.rs
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;index 05479d6..b85bbd1 100644
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-meta z-diff z-header z-from-file&quot;&gt;&lt;span class=&quot;z-meta z-header z-from-file z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-from-file z-diff&quot;&gt;---&lt;&#x2F;span&gt; a&#x2F;src&#x2F;lib.rs
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-meta z-diff z-header z-to-file&quot;&gt;&lt;span class=&quot;z-meta z-header z-to-file z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-to-file z-diff&quot;&gt;+++&lt;&#x2F;span&gt; b&#x2F;src&#x2F;lib.rs
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-meta z-diff z-range z-unified&quot;&gt;&lt;span class=&quot;z-meta z-range z-unified z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-range z-diff&quot;&gt;@@&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-toc-list z-line-number z-diff&quot;&gt;-32,7 +32,7&lt;&#x2F;span&gt; &lt;span class=&quot;z-punctuation z-definition z-range z-diff&quot;&gt;@@&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-section z-diff&quot;&gt;fn rust_main(msg: mpsc::Receiver&amp;lt;MainThreadMsg&amp;gt;) {&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;     a_log(&amp;quot;inside rust main&amp;quot;.to_owned());
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;     let instance = create_instance(
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;         &amp;amp;InstanceCreateInfo::new()
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-deleted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-deleted z-diff&quot;&gt;-&lt;&#x2F;span&gt;            .enabled_layer_name(&amp;amp;&amp;quot;VK_LAYER_KHRONOS_validation\0&amp;quot;.as_ptr())
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-inserted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-inserted z-diff&quot;&gt;+&lt;&#x2F;span&gt;            &#x2F;&#x2F;.enabled_layer_name(&amp;amp;&amp;quot;VK_LAYER_KHRONOS_validation\0&amp;quot;.as_ptr())
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;             .enabled_extension_names(&amp;amp;[
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;                 &amp;quot;VK_KHR_surface\0&amp;quot;.as_ptr(),
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;                 &amp;quot;VK_KHR_android_surface\0&amp;quot;.as_ptr(),
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-meta z-diff z-range z-unified&quot;&gt;&lt;span class=&quot;z-meta z-range z-unified z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-range z-diff&quot;&gt;@@&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-toc-list z-line-number z-diff&quot;&gt;-45,7 +45,7&lt;&#x2F;span&gt; &lt;span class=&quot;z-punctuation z-definition z-range z-diff&quot;&gt;@@&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-section z-diff&quot;&gt;fn rust_main(msg: mpsc::Receiver&amp;lt;MainThreadMsg&amp;gt;) {&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;         .create(
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;             &amp;amp;DeviceCreateInfo::new()
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;                 .enabled_extension_name(&amp;amp;&amp;quot;VK_KHR_swapchain\0&amp;quot;.as_ptr())
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-deleted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-deleted z-diff&quot;&gt;-&lt;&#x2F;span&gt;                .enabled_layer_name(&amp;amp;&amp;quot;VK_LAYER_KHRONOS_validation\0&amp;quot;.as_ptr())
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-inserted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-inserted z-diff&quot;&gt;+&lt;&#x2F;span&gt;               &#x2F;&#x2F; .enabled_layer_name(&amp;amp;&amp;quot;VK_LAYER_KHRONOS_validation\0&amp;quot;.as_ptr())
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;                 .queue_create_info(&amp;amp;DeviceQueueCreateInfo::new().queue_priority(&amp;amp;1f32)),
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;         )
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;         .unwrap();
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>Rust：在 Android 上调用 Skia 绘制</title>
        <published>2022-08-28T00:00:00+00:00</published>
        <updated>2022-08-28T00:00:00+00:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="https://kscr-rust.github.io/rust/rust-android-skia/"/>
        <id>https://kscr-rust.github.io/rust/rust-android-skia/</id>
        
        <content type="html" xml:base="https://kscr-rust.github.io/rust/rust-android-skia/">&lt;p&gt;NDK（C++）使用 Skia （OpenGLES后端）&lt;&#x2F;p&gt;
&lt;p&gt;https:&#x2F;&#x2F;github.com&#x2F;ngocdaothanh&#x2F;SkiaOpenGLESAndroid&lt;&#x2F;p&gt;
&lt;p&gt;JNI Skia （NewRasterDirect Bitmap）&lt;&#x2F;p&gt;
&lt;p&gt;https:&#x2F;&#x2F;chromium.googlesource.com&#x2F;skia&#x2F;+&#x2F;chrome&#x2F;m49&#x2F;platform_tools&#x2F;android&#x2F;examples&#x2F;hello_skia_app&#x2F;&lt;&#x2F;p&gt;
&lt;p&gt;NDK-SAMPLES 使用 OpenGL ES&lt;&#x2F;p&gt;
&lt;p&gt;https:&#x2F;&#x2F;github.com&#x2F;android&#x2F;ndk-samples&#x2F;blob&#x2F;main&#x2F;teapots&#x2F;classic-teapot&#x2F;&lt;&#x2F;p&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>如何用Rust做Android UI渲染</title>
        <published>2022-08-28T00:00:00+00:00</published>
        <updated>2022-08-28T00:00:00+00:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="https://kscr-rust.github.io/rust/rust-android-ui/"/>
        <id>https://kscr-rust.github.io/rust/rust-android-ui/</id>
        
        <content type="html" xml:base="https://kscr-rust.github.io/rust/rust-android-ui/">&lt;p&gt;https:&#x2F;&#x2F;juejin.cn&#x2F;post&#x2F;7002778072348885000&lt;&#x2F;p&gt;
&lt;h2 id=&quot;bei-jing&quot;&gt;背景&lt;&#x2F;h2&gt;
&lt;h2 id=&quot;rust-uixuan-ran&quot;&gt;Rust UI渲染&lt;&#x2F;h2&gt;
&lt;h3 id=&quot;ruan-jian-hui-zhi&quot;&gt;软件绘制&lt;&#x2F;h3&gt;
&lt;h3 id=&quot;ying-jian-hui-zhi&quot;&gt;硬件绘制&lt;&#x2F;h3&gt;
&lt;h2 id=&quot;zong-jie&quot;&gt;总结&lt;&#x2F;h2&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>Rust内核</title>
        <published>2022-08-28T00:00:00+00:00</published>
        <updated>2022-08-28T00:00:00+00:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="https://kscr-rust.github.io/rust/rust-kernel/"/>
        <id>https://kscr-rust.github.io/rust/rust-kernel/</id>
        
        <content type="html" xml:base="https://kscr-rust.github.io/rust/rust-kernel/">&lt;p&gt;https:&#x2F;&#x2F;os.phil-opp.com&#x2F;zh-CN&#x2F;&lt;&#x2F;p&gt;
&lt;p&gt;https:&#x2F;&#x2F;github.com&#x2F;rust-embedded&#x2F;rust-raspberrypi-OS-tutorials&lt;&#x2F;p&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>Rust笔记</title>
        <published>2022-08-28T00:00:00+00:00</published>
        <updated>2022-08-28T00:00:00+00:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="https://kscr-rust.github.io/rust/rust-notes/"/>
        <id>https://kscr-rust.github.io/rust/rust-notes/</id>
        
        <content type="html" xml:base="https://kscr-rust.github.io/rust/rust-notes/">&lt;h1 id=&quot;rust&quot;&gt;rust&lt;&#x2F;h1&gt;
&lt;h2 id=&quot;ji-chu-zhi-shi&quot;&gt;基础知识&lt;&#x2F;h2&gt;
&lt;p&gt;Rust 程序设计语言 中文版：https:&#x2F;&#x2F;kaisery.github.io&#x2F;trpl-zh-cn&#x2F;&lt;&#x2F;p&gt;
&lt;p&gt;通过例子学Rust 中文版：https:&#x2F;&#x2F;rustwiki.org&#x2F;zh-CN&#x2F;rust-by-example&#x2F;&lt;&#x2F;p&gt;
&lt;p&gt;Rust设计模式：http:&#x2F;&#x2F;chuxiuhong.com&#x2F;chuxiuhong-rust-patterns-zh&#x2F;&lt;&#x2F;p&gt;
&lt;p&gt;Rust语言圣经：https:&#x2F;&#x2F;course.rs  https:&#x2F;&#x2F;github.com&#x2F;sunface&#x2F;rust-course&lt;&#x2F;p&gt;
&lt;p&gt;Rust Crates 实践指南：https:&#x2F;&#x2F;mirrors.gitcode.host&#x2F;zzy&#x2F;rust-crate-guide&#x2F;index.html&lt;&#x2F;p&gt;
&lt;p&gt;Cargo 手册：https:&#x2F;&#x2F;rustwiki.org&#x2F;zh-CN&#x2F;cargo&#x2F;index.html&lt;&#x2F;p&gt;
&lt;p&gt;Rust的 Pin 与 Unpin ：https:&#x2F;&#x2F;folyd.com&#x2F;blog&#x2F;rust-pin-unpin&#x2F;&lt;&#x2F;p&gt;
&lt;h3 id=&quot;hong-bian-cheng&quot;&gt;宏编程&lt;&#x2F;h3&gt;
&lt;p&gt;Rust宏小册：https:&#x2F;&#x2F;zjp-cn.github.io&#x2F;tlborm&#x2F;proc-macros&lt;&#x2F;p&gt;
&lt;p&gt;Rust过程宏（Procedural Macros）基础：https:&#x2F;&#x2F;cloud.tencent.com&#x2F;developer&#x2F;article&#x2F;1832788&lt;&#x2F;p&gt;
&lt;h3 id=&quot;yi-bu-bian-cheng&quot;&gt;异步编程&lt;&#x2F;h3&gt;
&lt;p&gt;Rust中的异步编程：https:&#x2F;&#x2F;huangjj27.github.io&#x2F;async-book&#x2F;&lt;&#x2F;p&gt;
&lt;p&gt;对于 Async Rust，最最重要的莫过于底层的异步运行时，它提供了执行器、任务调度、异步API等核心服务。简单来说，使用 Rust 提供的 &lt;code&gt;async&#x2F;.await&lt;&#x2F;code&gt; 特性编写的异步代码要运行起来，就必须依赖于异步运行时，否则这些代码将毫无用处。&lt;&#x2F;p&gt;
&lt;p&gt;异步运行时：&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;tokio&lt;&#x2F;li&gt;
&lt;li&gt;async-std&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;Tokio异步编程: https:&#x2F;&#x2F;github.com&#x2F;sunface&#x2F;tokio-course&lt;&#x2F;p&gt;
&lt;h2 id=&quot;web&quot;&gt;web&lt;&#x2F;h2&gt;
&lt;p&gt;https:&#x2F;&#x2F;github.com&#x2F;flosse&#x2F;rust-web-framework-comparison&lt;&#x2F;p&gt;
&lt;h3 id=&quot;qian-duan&quot;&gt;前端&lt;&#x2F;h3&gt;
&lt;p&gt;yew：https:&#x2F;&#x2F;github.com&#x2F;yewstack&#x2F;yew&lt;&#x2F;p&gt;
&lt;h3 id=&quot;hou-duan&quot;&gt;后端&lt;&#x2F;h3&gt;
&lt;p&gt;rocket: https:&#x2F;&#x2F;github.com&#x2F;SergioBenitez&#x2F;rocket&lt;&#x2F;p&gt;
&lt;p&gt;actix-web: https:&#x2F;&#x2F;github.com&#x2F;actix&#x2F;actix-web&lt;&#x2F;p&gt;
&lt;h3 id=&quot;ke-hu-duan&quot;&gt;客户端&lt;&#x2F;h3&gt;
&lt;p&gt;reqwest: https:&#x2F;&#x2F;github.com&#x2F;seanmonstar&#x2F;reqwest&lt;&#x2F;p&gt;
&lt;h2 id=&quot;ying-yong-kai-fa&quot;&gt;应用开发&lt;&#x2F;h2&gt;
&lt;h3 id=&quot;ming-ling-xing&quot;&gt;命令行&lt;&#x2F;h3&gt;
&lt;p&gt;Command line apps in Rust：&lt;&#x2F;p&gt;
&lt;p&gt;https:&#x2F;&#x2F;rust-cli.github.io&#x2F;book&#x2F;&lt;&#x2F;p&gt;
&lt;p&gt;https:&#x2F;&#x2F;suibianxiedianer.github.io&#x2F;rust-cli-book-zh_CN&#x2F;&lt;&#x2F;p&gt;
&lt;p&gt;TUI（terminal user interfaces）：https:&#x2F;&#x2F;github.com&#x2F;fdehau&#x2F;tui-rs&lt;&#x2F;p&gt;
&lt;h3 id=&quot;gui&quot;&gt;GUI&lt;&#x2F;h3&gt;
&lt;p&gt;Iced：https:&#x2F;&#x2F;github.com&#x2F;iced-rs&#x2F;iced&lt;&#x2F;p&gt;
&lt;h2 id=&quot;ebpf&quot;&gt;ebpf&lt;&#x2F;h2&gt;
&lt;p&gt;aya：https:&#x2F;&#x2F;github.com&#x2F;aya-rs&#x2F;aya&lt;&#x2F;p&gt;
&lt;p&gt;https:&#x2F;&#x2F;github.com&#x2F;aya-rs&#x2F;awesome-aya&lt;&#x2F;p&gt;
&lt;p&gt;https:&#x2F;&#x2F;github.com&#x2F;aya-rs&#x2F;book&lt;&#x2F;p&gt;
&lt;h2 id=&quot;faq&quot;&gt;FAQ&lt;&#x2F;h2&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>在安卓中调用 rust 动态库</title>
        <published>2022-08-28T00:00:00+00:00</published>
        <updated>2022-08-28T00:00:00+00:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="https://kscr-rust.github.io/rust/rust-on-android/"/>
        <id>https://kscr-rust.github.io/rust/rust-on-android/</id>
        
        <content type="html" xml:base="https://kscr-rust.github.io/rust/rust-on-android/">&lt;h2 id=&quot;xiang-mu-jie-shao&quot;&gt;项目介绍&lt;&#x2F;h2&gt;
&lt;p&gt;项目链接：https:&#x2F;&#x2F;github.com&#x2F;martinwairegi&#x2F;rustonandroid&lt;&#x2F;p&gt;
&lt;p&gt;文件结构：&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash z-code&quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;z-source z-shell z-bash&quot;&gt;&lt;span class=&quot;z-meta z-function-call z-shell&quot;&gt;&lt;span class=&quot;z-variable z-function z-shell&quot;&gt;├──&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-function-call z-arguments z-shell&quot;&gt; android          &lt;span class=&quot;z-comment z-line z-number-sign z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-comment z-begin z-shell&quot;&gt;#&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-shell&quot;&gt; 安卓相关代码&lt;&#x2F;span&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-shell&quot;&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-shell z-bash&quot;&gt;&lt;span class=&quot;z-meta z-function-call z-shell&quot;&gt;&lt;span class=&quot;z-variable z-function z-shell&quot;&gt;├──&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-function-call z-arguments z-shell&quot;&gt; rust	     &lt;span class=&quot;z-comment z-line z-number-sign z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-comment z-begin z-shell&quot;&gt;#&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-shell&quot;&gt; rust 相关代码，调用 libgmp 库实现功能&lt;&#x2F;span&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-shell&quot;&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-shell z-bash&quot;&gt;&lt;span class=&quot;z-meta z-function-call z-shell&quot;&gt;&lt;span class=&quot;z-variable z-function z-shell&quot;&gt;├──&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-function-call z-arguments z-shell&quot;&gt; build-all.sh     &lt;span class=&quot;z-comment z-line z-number-sign z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-comment z-begin z-shell&quot;&gt;#&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-shell&quot;&gt; 全局构建脚本&lt;&#x2F;span&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-shell&quot;&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-shell z-bash&quot;&gt;&lt;span class=&quot;z-meta z-function-call z-shell&quot;&gt;&lt;span class=&quot;z-variable z-function z-shell&quot;&gt;├──&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-function-call z-arguments z-shell&quot;&gt; build-apk.sh     &lt;span class=&quot;z-comment z-line z-number-sign z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-comment z-begin z-shell&quot;&gt;#&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-shell&quot;&gt; 安卓 apk 编译构建脚本&lt;&#x2F;span&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-shell&quot;&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-shell z-bash&quot;&gt;&lt;span class=&quot;z-meta z-function-call z-shell&quot;&gt;&lt;span class=&quot;z-variable z-function z-shell&quot;&gt;├──&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-function-call z-arguments z-shell&quot;&gt; build-librpn.sh  &lt;span class=&quot;z-comment z-line z-number-sign z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-comment z-begin z-shell&quot;&gt;#&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-shell&quot;&gt; rust 动态库构建脚本&lt;&#x2F;span&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-shell&quot;&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-shell z-bash&quot;&gt;&lt;span class=&quot;z-meta z-function-call z-shell&quot;&gt;&lt;span class=&quot;z-variable z-function z-shell&quot;&gt;└──&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-function-call z-arguments z-shell&quot;&gt; build-libgmp.sh  &lt;span class=&quot;z-comment z-line z-number-sign z-shell&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-comment z-begin z-shell&quot;&gt;#&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-shell&quot;&gt; libgmp 构建脚本&lt;&#x2F;span&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-shell&quot;&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;***注意：***此项目代码使用 NDK-r23+ 无法编译成功，需要打补丁（见文末）。&lt;&#x2F;p&gt;
&lt;p&gt;主要因为以下两个原因：&lt;&#x2F;p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;NDK r23 之后 rust 编译报错 &lt;code&gt;ld: error: unable to find library -lgcc&lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;p&gt;解决方法见：https:&#x2F;&#x2F;github.com&#x2F;rust-lang&#x2F;rust&#x2F;pull&#x2F;85806#issuecomment-1096266946&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;项目编码错误&lt;&#x2F;p&gt;
&lt;p&gt;类名、函数名错误；编译脚本宏路径、名称错误。&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
&lt;p&gt;项目构建：&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash z-code&quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;z-source z-shell z-bash&quot;&gt;&lt;span class=&quot;z-meta z-function-call z-shell&quot;&gt;&lt;span class=&quot;z-variable z-function z-shell&quot;&gt;$&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-function-call z-arguments z-shell&quot;&gt; export ANDROID_SDK_ROOT=&#x2F;opt&#x2F;Android&#x2F;Sdk&#x2F;&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-shell z-bash&quot;&gt;&lt;span class=&quot;z-meta z-function-call z-shell&quot;&gt;&lt;span class=&quot;z-variable z-function z-shell&quot;&gt;$&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-function-call z-arguments z-shell&quot;&gt; export ANDROID_NDK_ROOT=&#x2F;opt&#x2F;Android&#x2F;Sdk&#x2F;ndk&#x2F;23.1.7779620&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-shell z-bash&quot;&gt;&lt;span class=&quot;z-meta z-function-call z-shell&quot;&gt;&lt;span class=&quot;z-variable z-function z-shell&quot;&gt;$&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-function-call z-arguments z-shell&quot;&gt; export ANDROID_API=29&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-shell z-bash&quot;&gt;&lt;span class=&quot;z-meta z-function-call z-shell&quot;&gt;&lt;span class=&quot;z-variable z-function z-shell&quot;&gt;$&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-function-call z-arguments z-shell&quot;&gt; .&#x2F;build-all.sh&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;zhi-shi-tuo-zhan&quot;&gt;知识拓展&lt;&#x2F;h2&gt;
&lt;p&gt;rust 库编译可以使用 cargo-ndk 工具。&lt;&#x2F;p&gt;
&lt;p&gt;https:&#x2F;&#x2F;github.com&#x2F;bbqsrc&#x2F;cargo-ndk&lt;&#x2F;p&gt;
&lt;h2 id=&quot;bu-ding&quot;&gt;补丁&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;diff&quot; class=&quot;language-diff z-code&quot;&gt;&lt;code class=&quot;language-diff&quot; data-lang=&quot;diff&quot;&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-meta z-diff z-header z-from-file&quot;&gt;&lt;span class=&quot;z-meta z-header z-from-file z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-from-file z-diff&quot;&gt;---&lt;&#x2F;span&gt; a&#x2F;build-libgmp.sh
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-meta z-diff z-header z-to-file&quot;&gt;&lt;span class=&quot;z-meta z-header z-to-file z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-to-file z-diff&quot;&gt;+++&lt;&#x2F;span&gt; b&#x2F;build-libgmp.sh
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-meta z-diff z-range z-unified&quot;&gt;&lt;span class=&quot;z-meta z-range z-unified z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-range z-diff&quot;&gt;@@&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-toc-list z-line-number z-diff&quot;&gt;-86,34 +86,34&lt;&#x2F;span&gt; &lt;span class=&quot;z-punctuation z-definition z-range z-diff&quot;&gt;@@&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-section z-diff&quot;&gt;fi&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; # If the build directory does not exist, create it.
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; if [[ ! -d &amp;quot;${TARGET_DIR}&amp;quot; ]]; then
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; 	# If we don&amp;#39;t have a local copy of the libgmp archive, download it.
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-deleted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-deleted z-diff&quot;&gt;-&lt;&#x2F;span&gt;	if [[ ! -f &amp;quot;${BUILD_DIR}&#x2F;gmp-${VERSION}.tar.lz&amp;quot; ]]; then
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-inserted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-inserted z-diff&quot;&gt;+&lt;&#x2F;span&gt;	if [[ ! -f &amp;quot;${BUILD_DIR}&#x2F;gmp-${VERSION}.tar.xz&amp;quot; ]]; then
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; 		cd &amp;quot;${BUILD_DIR}&amp;quot;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-deleted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-deleted z-diff&quot;&gt;-&lt;&#x2F;span&gt;		curl --remote-name &amp;quot;https:&#x2F;&#x2F;gmplib.org&#x2F;download&#x2F;gmp&#x2F;gmp-${VERSION}.tar.lz&amp;quot;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-inserted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-inserted z-diff&quot;&gt;+&lt;&#x2F;span&gt;		curl --remote-name &amp;quot;https:&#x2F;&#x2F;gmplib.org&#x2F;download&#x2F;gmp&#x2F;gmp-${VERSION}.tar.xz&amp;quot;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; 	fi
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; 
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; 	# Extract the libgmp archive.
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; 	mkdir -p &amp;quot;${BUILD_DIR}&#x2F;${ARCH}&#x2F;${BUILD_MODE}&amp;quot;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; 	cd &amp;quot;${BUILD_DIR}&#x2F;${ARCH}&#x2F;${BUILD_MODE}&amp;quot;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-deleted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-deleted z-diff&quot;&gt;-&lt;&#x2F;span&gt;	tar lxf &amp;quot;${BUILD_DIR}&#x2F;gmp-${VERSION}.tar.lz&amp;quot;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-inserted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-inserted z-diff&quot;&gt;+&lt;&#x2F;span&gt;	tar xf &amp;quot;${BUILD_DIR}&#x2F;gmp-${VERSION}.tar.xz&amp;quot;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; fi
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; 
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; # Set up the NDK tools for cross-compiling.
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; TOOLCHAIN=&amp;quot;${ANDROID_NDK_ROOT}&#x2F;toolchains&#x2F;llvm&#x2F;prebuilt&#x2F;linux-x86_64&#x2F;&amp;quot;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; if [[ &amp;quot;${ARCH}&amp;quot; == &amp;quot;armv7&amp;quot; ]]; then
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; 	HOST=&amp;quot;armv7a-linux-androideabi&amp;quot;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-deleted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-deleted z-diff&quot;&gt;-&lt;&#x2F;span&gt;	TOOL_PREFIX=&amp;quot;${TOOLCHAIN}&#x2F;bin&#x2F;arm-linux-androideabi&amp;quot;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-inserted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-inserted z-diff&quot;&gt;+&lt;&#x2F;span&gt;	TOOL_PREFIX=&amp;quot;${TOOLCHAIN}&#x2F;bin&#x2F;&amp;quot;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; else
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; 	HOST=&amp;quot;${ARCH}-linux-android&amp;quot;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-deleted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-deleted z-diff&quot;&gt;-&lt;&#x2F;span&gt;	TOOL_PREFIX=&amp;quot;${TOOLCHAIN}&#x2F;bin&#x2F;${HOST}&amp;quot;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-inserted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-inserted z-diff&quot;&gt;+&lt;&#x2F;span&gt;	TOOL_PREFIX=&amp;quot;${TOOLCHAIN}&#x2F;bin&#x2F;&amp;quot;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; fi
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; COMPILER_PREFIX=&amp;quot;${TOOLCHAIN}&#x2F;bin&#x2F;${HOST}${ANDROID_API}&amp;quot;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; 
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-deleted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-deleted z-diff&quot;&gt;-&lt;&#x2F;span&gt;export AR=&amp;quot;${TOOL_PREFIX}-ar&amp;quot;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-deleted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-deleted z-diff&quot;&gt;-&lt;&#x2F;span&gt;export AS=&amp;quot;${TOOL_PREFIX}-as&amp;quot;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-inserted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-inserted z-diff&quot;&gt;+&lt;&#x2F;span&gt;export AR=&amp;quot;${TOOL_PREFIX}llvm-ar&amp;quot;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-inserted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-inserted z-diff&quot;&gt;+&lt;&#x2F;span&gt;export AS=&amp;quot;${TOOL_PREFIX}llvm-as&amp;quot;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; export CC=&amp;quot;${COMPILER_PREFIX}-clang&amp;quot;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-deleted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-deleted z-diff&quot;&gt;-&lt;&#x2F;span&gt;export LD=&amp;quot;${TOOL_PREFIX}-ld&amp;quot;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-deleted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-deleted z-diff&quot;&gt;-&lt;&#x2F;span&gt;export RANLIB=&amp;quot;${TOOL_PREFIX}-ranlib&amp;quot;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-deleted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-deleted z-diff&quot;&gt;-&lt;&#x2F;span&gt;export STRIP=&amp;quot;${TOOL_PREFIX}-strip&amp;quot;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-inserted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-inserted z-diff&quot;&gt;+&lt;&#x2F;span&gt;export LD=&amp;quot;${TOOL_PREFIX}ld&amp;quot;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-inserted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-inserted z-diff&quot;&gt;+&lt;&#x2F;span&gt;export RANLIB=&amp;quot;${TOOL_PREFIX}llvm-ranlib&amp;quot;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-inserted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-inserted z-diff&quot;&gt;+&lt;&#x2F;span&gt;export STRIP=&amp;quot;${TOOL_PREFIX}llvm-strip&amp;quot;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; 
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; # Set up compiler flags.
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; if [[ &amp;quot;${BUILD_MODE}&amp;quot; == &amp;quot;release&amp;quot; ]]; then
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;diff --git a&#x2F;build-librpn.sh b&#x2F;build-librpn.sh
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;old mode 100644
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;new mode 100755
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;index a4730a4..509ba9a
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-meta z-diff z-header z-from-file&quot;&gt;&lt;span class=&quot;z-meta z-header z-from-file z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-from-file z-diff&quot;&gt;---&lt;&#x2F;span&gt; a&#x2F;build-librpn.sh
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-meta z-diff z-header z-to-file&quot;&gt;&lt;span class=&quot;z-meta z-header z-to-file z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-to-file z-diff&quot;&gt;+++&lt;&#x2F;span&gt; b&#x2F;build-librpn.sh
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-meta z-diff z-range z-unified&quot;&gt;&lt;span class=&quot;z-meta z-range z-unified z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-range z-diff&quot;&gt;@@&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-toc-list z-line-number z-diff&quot;&gt;-88,12 +88,12&lt;&#x2F;span&gt; &lt;span class=&quot;z-punctuation z-definition z-range z-diff&quot;&gt;@@&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-section z-diff&quot;&gt;cd &amp;quot;$(dirname &amp;quot;${BASH_SOURCE[0]}&amp;quot;)&#x2F;rust&#x2F;&amp;quot;&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; TOOLCHAIN=&amp;quot;${ANDROID_NDK_ROOT}&#x2F;toolchains&#x2F;llvm&#x2F;prebuilt&#x2F;linux-x86_64&amp;quot;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; if [[ &amp;quot;${ARCH}&amp;quot; == &amp;quot;armv7&amp;quot; ]]; then
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; 	HOST=&amp;quot;armv7a-linux-androideabi&amp;quot;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-deleted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-deleted z-diff&quot;&gt;-&lt;&#x2F;span&gt;	TOOL_PREFIX=&amp;quot;${TOOLCHAIN}&#x2F;bin&#x2F;arm-linux-androideabi&amp;quot;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-inserted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-inserted z-diff&quot;&gt;+&lt;&#x2F;span&gt;	TOOL_PREFIX=&amp;quot;${TOOLCHAIN}&#x2F;bin&#x2F;&amp;quot;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; 
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; 	RUST_TARGET=&amp;quot;armv7-linux-androideabi&amp;quot;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; else
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; 	HOST=&amp;quot;${ARCH}-linux-android&amp;quot;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-deleted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-deleted z-diff&quot;&gt;-&lt;&#x2F;span&gt;	TOOL_PREFIX=&amp;quot;${TOOLCHAIN}&#x2F;bin&#x2F;${HOST}&amp;quot;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-inserted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-inserted z-diff&quot;&gt;+&lt;&#x2F;span&gt;	TOOL_PREFIX=&amp;quot;${TOOLCHAIN}&#x2F;bin&#x2F;&amp;quot;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; 
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; 	RUST_TARGET=&amp;quot;${ARCH}-linux-android&amp;quot;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; fi
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-meta z-diff z-range z-unified&quot;&gt;&lt;span class=&quot;z-meta z-range z-unified z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-range z-diff&quot;&gt;@@&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-toc-list z-line-number z-diff&quot;&gt;-111,7 +111,7&lt;&#x2F;span&gt; &lt;span class=&quot;z-punctuation z-definition z-range z-diff&quot;&gt;@@&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-section z-diff&quot;&gt;fi&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; #
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; # The RUSTFLAGS variable sets up the linking path (tells rustc where to look for dependencies).
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; env \
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-deleted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-deleted z-diff&quot;&gt;-&lt;&#x2F;span&gt;	&amp;quot;AR_${RUST_TARGET}=${TOOL_PREFIX}-ar&amp;quot; \
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-inserted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-inserted z-diff&quot;&gt;+&lt;&#x2F;span&gt;	&amp;quot;AR_${RUST_TARGET}=${TOOL_PREFIX}llvm-ar&amp;quot; \
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; 	&amp;quot;CC_${RUST_TARGET}=${COMPILER_PREFIX}-clang&amp;quot; \
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; 	&amp;quot;CARGO_TARGET_${RUST_TARGET_CAPS}_LINKER=${COMPILER_PREFIX}-clang&amp;quot; \
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; 	&amp;quot;RUSTFLAGS=-L ${LIBS_DIR}&amp;quot; \
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;diff --git a&#x2F;build&#x2F;libgmp&#x2F;gmp-6.2.1.tar.lz b&#x2F;build&#x2F;libgmp&#x2F;gmp-6.2.1.tar.lz
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;deleted file mode 100644
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;index f02b412..0000000
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;Binary files a&#x2F;build&#x2F;libgmp&#x2F;gmp-6.2.1.tar.lz and &#x2F;dev&#x2F;null differ
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;diff --git a&#x2F;rust&#x2F;src&#x2F;android.rs b&#x2F;rust&#x2F;src&#x2F;android.rs
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;index 68d3883..a08efd0 100644
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-meta z-diff z-header z-from-file&quot;&gt;&lt;span class=&quot;z-meta z-header z-from-file z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-from-file z-diff&quot;&gt;---&lt;&#x2F;span&gt; a&#x2F;rust&#x2F;src&#x2F;android.rs
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-meta z-diff z-header z-to-file&quot;&gt;&lt;span class=&quot;z-meta z-header z-to-file z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-to-file z-diff&quot;&gt;+++&lt;&#x2F;span&gt; b&#x2F;rust&#x2F;src&#x2F;android.rs
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-meta z-diff z-range z-unified&quot;&gt;&lt;span class=&quot;z-meta z-range z-unified z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-range z-diff&quot;&gt;@@&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-toc-list z-line-number z-diff&quot;&gt;-54,7 +54,7&lt;&#x2F;span&gt; &lt;span class=&quot;z-punctuation z-definition z-range z-diff&quot;&gt;@@&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-section z-diff&quot;&gt;where&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; 	 * and hope for the best.
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; 	 *&#x2F;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; 	let class = env
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-deleted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-deleted z-diff&quot;&gt;-&lt;&#x2F;span&gt;		.find_class(&amp;quot;pl&#x2F;svgames&#x2F;blog&#x2F;RustOnAndroid&#x2F;Result&amp;quot;)
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-inserted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-inserted z-diff&quot;&gt;+&lt;&#x2F;span&gt;		.find_class(&amp;quot;pl&#x2F;martin&#x2F;blog&#x2F;RustOnAndroid&#x2F;Result&amp;quot;)
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; 		.unwrap();
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; 	let args: [JValue&amp;lt;&amp;#39;e&amp;gt;; 2] = [
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; 		JValue::Bool(u8::from(is_ok)),
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-meta z-diff z-range z-unified&quot;&gt;&lt;span class=&quot;z-meta z-range z-unified z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-range z-diff&quot;&gt;@@&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-toc-list z-line-number z-diff&quot;&gt;-71,7 +71,7&lt;&#x2F;span&gt; &lt;span class=&quot;z-punctuation z-definition z-range z-diff&quot;&gt;@@&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-section z-diff&quot;&gt;fn rpn_wrapper(env: &amp;amp;JNIEnv, expression: JString) -&amp;gt; Result&amp;lt;BigNum&amp;gt; {&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; }
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; 
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; #[no_mangle]
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-deleted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-deleted z-diff&quot;&gt;-&lt;&#x2F;span&gt;pub extern &amp;quot;system&amp;quot; fn Java_pl_svgames_blog_RustOnAndroid_RpnCalculator_rpn&amp;lt;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt;&lt;span class=&quot;z-markup z-inserted z-diff&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-inserted z-diff&quot;&gt;+&lt;&#x2F;span&gt;pub extern &amp;quot;system&amp;quot; fn Java_pl_martin_blog_RustOnAndroid_RpnCalculator_rpn&amp;lt;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; 	&amp;#39;e,
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; &amp;gt;(
&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-diff&quot;&gt; 	env: JNIEnv&amp;lt;&amp;#39;e&amp;gt;,
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
</content>
        
    </entry>
</feed>
